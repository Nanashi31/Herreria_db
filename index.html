<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Herremex - Herrería Profesional</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #fffaf6;
    }
    .btn-dark {
      background-color: #0c0a1f;
      border: none;
    }
    .text-orange {
      color: #ff5e00;
    }
    .rounded-soft {
      border-radius: 1.5rem;
    }
    .shadow-soft {
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    .nav-tabs .nav-link.active {
      background-color: #0c0a1f;
      color: #fff;
    }
    .hero-btn {
      scroll-behavior: smooth;
    }
  </style>
</head>
<body>
  <!-- HERO SECCION -->
  <header class="container py-4">
    <div class="d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center gap-2">
        <img src="https://img.icons8.com/color/48/000000/welder.png" alt="Logo">
        <div>
          <h5 class="mb-0 fw-bold text-orange">Herremex</h5>
          <small class="text-muted">Herrería Profesional</small>
        </div>
      </div>
      <div class="d-flex gap-3">
        <a href="#crud" class="btn btn-outline-secondary">Ir al Panel</a>
        <button class="btn btn-dark">⛶ Iniciar Sesión</button>
      </div>
    </div>
    <hr>
    <div class="row align-items-center mt-4">
      <div class="col-md-6">
        <span class="badge bg-light text-dark mb-2">Herrería Profesional desde 2008</span>
        <h1 class="fw-bold display-5">Forjamos tus <span class="text-orange">Ideas</span> en Metal</h1>
        <p class="text-muted">Especialistas en herrería artística e industrial. Desde portones automatizados hasta estructuras complejas, creamos soluciones de metal que duran para toda la vida.</p>
        <div class="d-flex gap-2">
          <a href="#crud" class="btn btn-dark hero-btn">Comenzar Proyecto</a>
          <button class="btn btn-outline-dark">▶ Ver Portafolio</button>
        </div>
        <div class="d-flex gap-4 mt-4">
          <div><h4 class="text-orange fw-bold">500+</h4><p class="mb-0">Proyectos</p></div>
          <div><h4 class="text-orange fw-bold">15+</h4><p class="mb-0">Años</p></div>
          <div><h4 class="text-orange fw-bold">98%</h4><p class="mb-0">Satisfacción</p></div>
        </div>
      </div>
      <div class="col-md-6 position-relative">
        <div class="bg-warning bg-opacity-10 p-2 rounded-soft">
          <img src="https://images.unsplash.com/photo-1558008258-3256797b43f3" class="img-fluid rounded" alt="Chispa metal">
        </div>
        <div class="position-absolute bottom-0 start-0 translate-middle-y shadow-soft bg-white p-3 rounded border">
          <div class="d-flex align-items-center gap-2">
            <img src="https://img.icons8.com/fluency/32/000000/star.png" alt="Estrella">
            <div>
              <strong>4.9/5 Estrellas</strong><br>
              <small class="text-muted">+200 reseñas</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- CRUD SECCIONES EN TABS -->
  <main class="container mt-5" id="crud">
    <ul class="nav nav-tabs" id="crudTabs" role="tablist"></ul>
    <div class="tab-content pt-4" id="crudContent"></div>
  </main>

  <!-- SCRIPT DE FUNCIONALIDAD CRUD -->
  <script>
    const sections = [
      { id: 'clientes', title: 'Clientes', api: 'clientes', fields: ['Id_Cli', 'Nom', 'ApP', 'ApM', 'Cel', 'Dire'] },
      { id: 'ordenes', title: 'Órdenes', api: 'ordenes', fields: ['Id_Ord', 'Tipo', 'Presupuesto', 'Id_Cliente', 'Fecha'] },
      { id: 'inventario', title: 'Inventario', api: 'inventario', fields: ['Id_Mat', 'Nombre', 'Precio', 'Tipo'] },
      { id: 'trabajadores', title: 'Trabajadores', api: 'trabajadores', fields: ['Id_Tra', 'Nom', 'ApP', 'ApM', 'Correo', 'Tel', 'Fec_Nac'] },
      { id: 'orden_inv', title: 'Orden-Material', api: 'ordenes-materiales', fields: ['Id_Ord', 'Id_Mat', 'Usado'] }
    ];

    const tabList = document.getElementById('crudTabs');
    const content = document.getElementById('crudContent');

    sections.forEach(({ id, title }, index) => {
      tabList.innerHTML += `<li class="nav-item"><button class="nav-link ${index === 0 ? 'active' : ''}" data-bs-toggle="tab" data-bs-target="#${id}-tab">${title}</button></li>`;
      content.innerHTML += `<div class="tab-pane fade ${index === 0 ? 'show active' : ''}" id="${id}-tab"><div class="container py-4" id="${id}-section"></div></div>`;
    });

    sections.forEach(({ id, title, api, fields }) => {
      const sec = document.getElementById(`${id}-section`);
      sec.innerHTML = `
        <h2 class="mb-3">Gestión de ${title}</h2>
        <form id="form_${id}" class="row g-2 mb-3">
          ${fields.map(f => `<div class="col-md-${12 / fields.length}"><input class="form-control" id="${f}_${id}" placeholder="${f}"></div>`).join('')}
          <div class="col-12"><button type="submit" class="btn btn-dark">Guardar</button></div>
        </form>
        <div class="table-responsive">
          <table class="table table-bordered table-striped">
            <thead class="table-dark"><tr>${fields.map(f => `<th>${f}</th>`).join('')}<th>Acciones</th></tr></thead>
            <tbody id="tabla_${id}"></tbody>
          </table>
        </div>
      `;
    });

    sections.forEach(({ id, api, fields }) => {
      const apiUrl = `http://localhost:5000/${api}`;
      const form = document.getElementById(`form_${id}`);
      const tabla = document.getElementById(`tabla_${id}`);

      const cargar = () => {
        fetch(apiUrl).then(r => r.json()).then(data => {
          tabla.innerHTML = '';
          data.forEach(item => {
            tabla.innerHTML += `
              <tr>
                ${fields.map(f => `<td>${item[f]}</td>`).join('')}
                <td>
                  <button class='btn btn-sm btn-warning' onclick='editar_${id}(${JSON.stringify(item)})'>Editar</button>
                  <button class='btn btn-sm btn-danger' onclick='eliminar_${id}(${fields.map(f => `"${item[f]}"`).join(',')})'>Eliminar</button>
                </td>
              </tr>
            `;
          });
        });
      };

      form.addEventListener('submit', e => {
        e.preventDefault();
        const datos = {};
        fields.forEach(f => datos[f] = document.getElementById(`${f}_${id}`).value);
        fetch(`${apiUrl}`, {
          method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(datos)
        }).then(() => { form.reset(); cargar(); });
      });

      window[`editar_${id}`] = (obj) => {
        fields.forEach(f => document.getElementById(`${f}_${id}`).value = obj[f]);
      };

      window[`eliminar_${id}`] = (...ids) => {
        const params = id === 'orden_inv' ? `?Id_Ord=${ids[0]}&Id_Mat=${ids[1]}` : `/${ids[0]}`;
        fetch(`${apiUrl}${params}`, { method: 'DELETE' }).then(cargar);
      };

      cargar();
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
